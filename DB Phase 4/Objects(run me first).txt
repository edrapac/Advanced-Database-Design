
DROP TYPE PER_P FORCE;
DROP TYPE EMP_P FORCE;
DROP TYPE CUST_ORDERS_ARR FORCE;
DROP TYPE CUST_P FORCE;
DROP TYPE ADDRESS_P FORCE; 
DROP TYPE address_tab FORCE;
CREATE OR REPLACE TYPE PER_P AS OBJECT
(
LAST_NAME VARCHAR(20),
FIRST_NAME VARCHAR(20),
DOB DATE,
GENDER CHAR (1),
MEMBER FUNCTION AGE RETURN NUMBER,
PRAGMA RESTRICT_REFERENCES(AGE,WNDS)
)
NOT FINAL;
/

CREATE OR REPLACE TYPE EMP_P UNDER PER_P --this will just hold the generic job titles and rates instead of a job title table

(
POSITION VARCHAR(30),
RATE NUMBER,
COMISSION DECIMAL(1,2)
);
/

CREATE OR REPLACE TYPE CUST_ORDERS_ARR AS VARRAY(4)
OF NUMBER (38);
/

CREATE OR REPLACE TYPE CUST_P UNDER PER_P
(
ORDER_SUMMARY CUST_ORDERS_ARR
);
/

CREATE OR REPLACE TYPE ADDRESS_P AS OBJECT
(
STREET_NUMBER VARCHAR2(10),
STREET_NAME VARCHAR2(30),
CITY VARCHAR2(30),
STATE VARCHAR2(2),
POSTAL_CODE NUMBER(10)
);
/
CREATE TYPE address_tab AS TABLE OF
ADDRESS_P;
/

CREATE OR REPLACE TYPE BODY PER_P AS 
MEMBER FUNCTION AGE RETURN NUMBER
IS
	V_AGE NUMBER;
	BEGIN
		V_AGE := TRUNC((SYSDATE-SELF.DOB)/365.25);
		RETURN V_AGE;
	END;
END;
/